<!DOCTYPE html>
<html lang="en-us" class="wf-firasans-n4-active wf-active">
	<head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Enable responsiveness on mobile devices --> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    
    	
    <meta name="generator" content="Hugo 0.37.1" />
    
    <title>CheckByNet &middot; YourTech</title>
    <meta content="CheckByNet - YourTech" property="og:title">
    <meta content=" - " property="og:description">    
    <!-- CSS --> 
    <link href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i|Roboto+Mono:300,300i,400,400i,700,700i" rel="stylesheet">
    <link rel="stylesheet" href="http://localhost:1313css/print.css" media="print">
    <link rel="stylesheet" href="http://localhost:1313css/poole.css">
    <link rel="stylesheet" href="http://localhost:1313css/hyde.css">
    
    <script defer src="https://use.fontawesome.com/releases/v5.0.9/js/all.js" integrity="sha384-8iPTk2s/jMVj81dnzb/iFR2sdA7u06vHJyyLlAd4snFpCl/SnyUjRrbdJsw1pGIl" crossorigin="anonymous"></script>
    <!-- highlight.js--> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
    <!-- Customised CSS -->
    <link rel="stylesheet" href="http://localhost:1313css/custom.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    

	</head>
    <body class="theme-base-0b " >
        <div class="sidebar">
	<div class="container text-center sidebar-sticky">
		<div class="sidebar-about text-center">
			<a href="http://localhost:1313"><h1 class="brand">YourTech</h1></a>
			 <img src="/img/ytjohnthumbnail.png" alt="Author Image" class="img-circle headshot center"> 
			<p class="lead">
				 Just your average, ordinary, everyday, super admin. 
			</p>
		</div>
		
<div>
	<ul class="sidebar-nav">
		
		
				<li>
					<a href="/posts/"> <span>Posts</span></a>
				</li>
				<li>
					<a href="/about/"> <span>About</span></a>
				</li>
		</li>
	</ul>
</div>

        <p>
		<section class="row text-center">
	
	<a href="https://twitter.com/ytjohn"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	&nbsp;<a href="https://github.com/ytjohn"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	&nbsp;<a href="https://stackoverflow.com/users/ytjohn"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	&nbsp;<a href="mailto:john@yourtech.us"><i class="fas fa-at fa-lg" aria-hidden="true"></i></a>
	
</section>

        </p>

		<p class="copyright">&copy; 2018 John Hogenmiller.
        <a href="https://creativecommons.org/licenses/by/4.0">Some Rights Reserved</a>.<br/>Built with <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
        </p>
	</div>
	<div>
	</div>
</div>

        <div class="content container">
            <div class="post">
  <h1>CheckByNet</h1>
  
  <div class="col-sm-12 col-md-12">
    <span class="text-left post-date meta">
            
       
        <i class="fas fa-calendar-alt"></i> 2004-05-27
      
      
      
      
      </span>  
  </div>    
  
  <p>/*
echeck.class, Copyright 2004 John Hogenmiller john@hsource.net
<a href="http://h.hsource.net/">http://h.hsource.net/</a>
This is an api to interface with ChecksByNet (<a href="http://www.checksbynet.com/">http://www.checksbynet.com/</a>), provided
by CrossCheck, Inc. This program is in no way (currently) endorsed by Crosscheck, Inc., nor is the author in any way affiliated with CrossCheck, Inc.
Distribution:
This program is released under the GNU Lesser General Public License.
(<a href="http://www.opensource.org/licenses/lgpl-license.php">http://www.opensource.org/licenses/lgpl-license.php</a>)
CONFIGURATION:
Go to the function post_echeck and change the $payto and $paytoid variables
to match what you have with ChecksByNet.  Alternatively, you could pass these
in from the parent script.  If ChecksByNet ever changes their
submission url, you&rsquo;ll have to change the $url variable.
EXAMPLE:
Note that in a production environment, you wouldn&rsquo;t want to pass $<em>REQUEST in
to the post_echeck function as the end user would be able to change the amount,
payto, and paytoid at will.  Ideally, you pull the cbn</em> variables out of
$<em>REQUEST, do any regex checks you want to do on your side, and directly
set the amount from the server side.
post_echeck works by returning an array with the keys &ldquo;approved&rdquo; and &ldquo;err&rdquo;.
$array[&lsquo;approved&rsquo;]   // If set, echeck was approved.
$array[&lsquo;err&rsquo;]        // Human readable text of all errors.
$array[&lsquo;RSPxxxx&rsquo;]    // Server generated error as key, human readable error as value.
Useful for parent scripts that want to do more with the error.
$ec = new echeck;
$result = $ec-&gt;post_echeck($_REQUEST);
if ($result[approved])
{ print &ldquo;Echeck approved
\n&rdquo;; }
else
{ print &ldquo;Declined:
\n&rdquo;;
print $result[err];
}
VARIABLES:
Put all the variables into an array and pass that array to post_echeck.
Prefix all variables in the array with cbn</em>
Example:
$checkno = 123;
$check[&lsquo;cbn_checknbr&rsquo;] = $checkno;
$result = $ec-&gt;post_echeck($check);
Checksbynet requires the following variables FROM THE CUSTOMER:
Check Number Value: checknbr            Needs to be greater than 99 / 6 Max
Customer&rsquo;s First Name: writerfirst      15 Max    (only for personal checks)
Customer&rsquo;s Last Name:   writerlast      29 Max
Customer&rsquo;s Business Name: writername    50 Max    (only for business checks)
Customer&rsquo;s Address: writeraddr          Street address required / 50 Max
City: writercity                        30 Max
State: writerst                         2 characters required
Zip: writerzip                          5 digits required
Bank Name: bankname                     50 Max
Bank City: bankcity                     30 Max
Bank State: bankst                      2 characters required
Bank Zip: bankzip                       5 digits required or can be blank
MICR: micr                              80 Max
Customer&rsquo;s Driver&rsquo;s License: idnbr      Do not include dashes or spaces / 40 Max
Driver&rsquo;s License State: idst            2 characters required
Customer&rsquo;s Phone Number: phone          10 digits required / 14 max
Customer&rsquo;s Email: email                 &ldquo;@&rdquo; and &ldquo;.&rdquo; required / 50 Max
They also require these variables FROM THE MERCHANT:
Check Dollar Amount Value: checkamt Needs to be greater than $1.00/ 10 Max characters
These variables are required by the MERCHANT, but can be set in the post_echeck
function, and do not need to be passed in from the parent program.:
Pay to: payto               Who the check is being made out to. 50 Max
Pay to id: paytoid          Merchant id number
*/
class echeck
{
function post_echeck($check)
{
$url = &lsquo;<a href="https://cross.checksbynet.com/response.asp'">https://cross.checksbynet.com/response.asp'</a>;
if ($check[cbn_payto])
{ $payto = urlencode($check[cbn_payto]); }
else { $payto = urlencode(&ldquo;Valued CrossCheck Merchant&rdquo;); }
if ($check[cbn_paytoid])
{ $paytoid = urlencode($check[cbn_paytoid]); }
else { $paytoid = &ldquo;12345&rdquo;; }
// For initial testing, you may want to NULL out the paytoid
$paytoid = 0;
$params =
&ldquo;payto=$payto&rdquo;
. &ldquo;&amp;checknbr=&ldquo;.     urlencode($check[&lsquo;cbn_checknbr&rsquo;])
. &ldquo;&amp;checkamt=&ldquo;.     urlencode($check[&lsquo;cbn_checkamt&rsquo;])
. &ldquo;&amp;writeraddr=&ldquo;.   urlencode($check[&lsquo;cbn_writeraddr&rsquo;])
. &ldquo;&amp;writercity=&ldquo;.   urlencode($check[&lsquo;cbn_writercity&rsquo;])
. &ldquo;&amp;writerst=&ldquo;.     urlencode($check[&lsquo;cbn_writerst&rsquo;])
. &ldquo;&amp;writerzip=&ldquo;.    urlencode($check[&lsquo;cbn_writerzip&rsquo;])
. &ldquo;&amp;bankname=&ldquo;.     urlencode($check[&lsquo;cbn_bankname&rsquo;])
. &ldquo;&amp;bankcity=&ldquo;.     urlencode($check[&lsquo;cbn_bankcity&rsquo;])
. &ldquo;&amp;bankst=&ldquo;.       urlencode($check[&lsquo;cbn_bankst&rsquo;])
. &ldquo;&amp;micr=&ldquo;.     urlencode($check[&lsquo;cbn_micr&rsquo;])
. &ldquo;&amp;idnbr=&ldquo;.        urlencode($check[&lsquo;cbn_idnbr&rsquo;])
. &ldquo;&amp;idst=&ldquo;.     urlencode($check[&lsquo;cbn_idst&rsquo;])
. &ldquo;&amp;phone=&ldquo;.        urlencode($check[&lsquo;cbn_phone&rsquo;])
. &ldquo;&amp;email=&ldquo;.        urlencode($check[&lsquo;cbn_email&rsquo;]);
if ($check[&lsquo;cbn_bankzip&rsquo;])     {    $params .=  &ldquo;&amp;bankzip=&ldquo;.        $check[&lsquo;cbn_bankzip&rsquo;]; }
if ($check[&lsquo;cbn_writername&rsquo;]) { $params .=  &ldquo;&amp;writername=&ldquo;. $check[&lsquo;cbn_writername&rsquo;];      }
else { $params .= &ldquo;&amp;writerfirst=&ldquo;. $check[&lsquo;cbn_writerfirst&rsquo;] . &ldquo;&amp;writerlast=&ldquo;. $check[&lsquo;cbn_writerlast&rsquo;]; }
if ($paytoid) { $params .= &ldquo;&amp;paytoid=&ldquo;. $paytoid; }
$ch = curl_init();
curl_setopt($ch, CURLOPT_POST,1);
curl_setopt($ch, CURLOPT_POSTFIELDS,$params);
curl_setopt($ch, CURLOPT_URL,$url);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST,  2);
// curl_setopt($ch, CURLOPT_USERAGENT, $defined_vars[&lsquo;HTTP_USER_AGENT&rsquo;]);
curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
$return=curl_exec($ch);
curl_close ($ch);
$goodresults = $this-&gt;quotesplit($return);
foreach ($goodresults as $key =&gt; $value)
{
$result[$value] = &ldquo;ECHECK: Unknown error&rdquo;; // All known return codes will replace this.
if ($value == &lsquo;RSP0051&rsquo;) { $result[err] .= &ldquo;ECHECK: Configuration error: invalid payto/paytoid&rdquo;;
$result[$value] .= &ldquo;ECHECK: Configuration error: invalid payto/paytoid&rdquo;; }
if ($value == &lsquo;RSP1101&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  check number
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  check number
\n&rdquo;; }
if ($value == &lsquo;RSP1102&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  check dollar amount
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  check dollar amount
\n&rdquo;; }
if ($value == &lsquo;RSP1201&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  entry for customer name
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  entry for customer name
\n&rdquo;; }
if ($value == &lsquo;RSP1202&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  address for customer $check[cbn_writeraddr]
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank address for customer $check[cbn_writeraddr]
\n&rdquo;; }
if ($value == &lsquo;RSP1203&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  city for customer
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  city for customer
\n&rdquo;; }
if ($value == &lsquo;RSP1204&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  state for customer
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  state for customer
\n&rdquo;; }
if ($value == &lsquo;RSP1205&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  zip code for customer
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  zip code for customer
\n&rdquo;; }
if ($value == &lsquo;RSP1301&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  bank name
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  bank name
\n&rdquo;; }
if ($value == &lsquo;RSP1302&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  city for bank
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  city for bank
\n&rdquo;; }
if ($value == &lsquo;RSP1303&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  state for bank
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  state for bank
\n&rdquo;; }
if ($value == &lsquo;RSP1304&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  zip code for bank
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  zip code for bank
\n&rdquo;; }
if ($value == &lsquo;RSP1311&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  account number
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  account number
\n&rdquo;; }
if ($value == &lsquo;RSP1312&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  routing number
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  routing number
\n&rdquo;; }
if ($value == &lsquo;RSP1313&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  micr number
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  micr number
\n&rdquo;; }
if ($value == &lsquo;RSP1401&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  driver&rsquo;s license number
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  driver&rsquo;s license number
\n&rdquo;; }
if ($value == &lsquo;RSP1402&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  state for driver&rsquo;s license
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  state for driver&rsquo;s license
\n&rdquo;; }
if ($value == &lsquo;RSP1501&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  phone number for customer
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  phone number for customer
\n&rdquo;; }
if ($value == &lsquo;RSP1502&rsquo;) { $result[err] .= &ldquo;ECHECK: Bad/blank  email address for customer
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Bad/blank  email address for customer
\n&rdquo;; }
if ($value == &lsquo;RSP0000&rsquo;) { $result[approved] = 1; $result[err] = 0; }
if ($value == &lsquo;RSP0001&rsquo;) { $result[approved] = 0; $result[err] .= &ldquo;ECHECK: Declined
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: ECHECK: Declined
\n&rdquo;; }
if ($value == &lsquo;RSP0020&rsquo;) { $result[err] .= &ldquo;ECHECK: Check duplication error. We have approved this same check number from the same account in recent history.
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Check duplication error. We have approved this same check number from the same account in recent history.
\n&rdquo;; }
if ($value == &lsquo;RSP9999&rsquo;) { $result[err] .= &ldquo;ECHECK: Unable to process checks at this time
\n&rdquo;;
$result[$value] = &ldquo;ECHECK: Unable to process checks at this time
\n&rdquo;; }
// Enable the below line for testing
if ($value == &lsquo;RSP0010&rsquo;) { $result[approved] = 1; $result[err] = 0;
$result[$value] = &ldquo;ECHECK: Test completed.&ldquo;;}
}
if (!$result[err] &amp;&amp; !$result[approved]) { $result[err] .= &ldquo;ECHECK: Undefined error, not approved&rdquo;; }
return($result);
} #end function post_echeck
function quotesplit($s)
{
$r = Array();
$p = 0;
$l = strlen($s);
while ($p &lt; $l) {
while (($p &lt; $l) &amp;&amp; (strpos(&rdquo; \r\t\n&rdquo;,$s[$p]) !== false)) $p++;
if ($s[$p] == &lsquo;&ldquo;&rsquo;) {
$p++;
$q = $p;
while (($p &lt; $l) &amp;&amp; ($s[$p] != &lsquo;&ldquo;&rsquo;)) {
if ($s[$p] == &lsquo;&#92;&rsquo;) { $p+=2; continue; }
$p++;
}
$r[] = stripslashes(substr($s, $q, $p-$q));
$p++;
while (($p &lt; $l) &amp;&amp; (strpos(&rdquo; \r\t\n&rdquo;,$s[$p]) !== false)) $p++;
$p++;
} else if ($s[$p] == &ldquo;&lsquo;&rdquo;) {
$p++;
$q = $p;
while (($p &lt; $l) &amp;&amp; ($s[$p] != &ldquo;&lsquo;&rdquo;)) {
if ($s[$p] == &lsquo;&#92;&rsquo;) { $p+=2; continue; }
$p++;
}
$r[] = stripslashes(substr($s, $q, $p-$q));
$p++;
while (($p &lt; $l) &amp;&amp; (strpos(&rdquo; \r\t\n&rdquo;,$s[$p]) !== false)) $p++;
$p++;
} else {
$q = $p;
while (($p &lt; $l) &amp;&amp; (strpos(&ldquo;,;&rdquo;,$s[$p]) === false)) {
$p++;
}
$r[] = stripslashes(trim(substr($s, $q, $p-$q)));
while (($p &lt; $l) &amp;&amp; (strpos(&rdquo; \r\t\n&rdquo;,$s[$p]) !== false)) $p++;
$p++;
}
}
return $r;
} # end function quotesplit
} # end class echeck
?&gt;</p>

</div>
            <div class="footer">
                <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

<script type="text/javascript">
    hljs.initHighlightingOnLoad();
</script>



            </div>
        </div>
        
                
    </body>
</html>
